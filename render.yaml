# ====================================================
# Render.com ãƒ‡ãƒ—ãƒ­ã‚¤è¨­å®šãƒ•ã‚¡ã‚¤ãƒ«
# AI Avatar REI - Kyo-Yuzen Chatbot System
# ====================================================

services:
  # ãƒ¡ã‚¤ãƒ³Webã‚µãƒ¼ãƒ“ã‚¹ï¼ˆFlask + Socket.IOï¼‰
  - type: web
    name: ai-avatar-rei
    runtime: python
    region: singapore  # æ—¥æœ¬ã«è¿‘ã„ãƒªãƒ¼ã‚¸ãƒ§ãƒ³
    plan: starter  # $7/æœˆãƒ—ãƒ©ãƒ³ï¼ˆæ°¸ç¶šãƒ‡ã‚£ã‚¹ã‚¯ä»˜ãï¼‰
    
    # ãƒ“ãƒ«ãƒ‰è¨­å®š
    buildCommand: bash build.sh
    startCommand: gunicorn application:app --bind 0.0.0.0:$PORT --workers 1 --threads 4 --timeout 120 --preload --log-level info
    
    # ç’°å¢ƒå¤‰æ•°ï¼ˆRenderãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§è¨­å®šãŒå¿…è¦ï¼‰
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      
      - key: PORT
        value: 8000
      
      # OpenAI APIï¼ˆå¿…é ˆï¼‰
      - key: OPENAI_API_KEY
        sync: false  # Renderãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§æ‰‹å‹•è¨­å®š
      
      # Azure Speech Serviceï¼ˆå¿…é ˆãƒ»éŸ³å£°åˆæˆç”¨ï¼‰
      - key: AZURE_SPEECH_KEY
        sync: false
      
      - key: AZURE_SPEECH_REGION
        value: japaneast
      
      - key: AZURE_VOICE_NAME
        value: ja-JP-NanamiNeural
      
      # Flaskè¨­å®š
      - key: FLASK_ENV
        value: production
      
      - key: SECRET_KEY
        generateValue: true  # ãƒ©ãƒ³ãƒ€ãƒ ãªå€¤ã‚’è‡ªå‹•ç”Ÿæˆ
    
    # æ°¸ç¶šãƒ‡ã‚£ã‚¹ã‚¯è¨­å®šï¼ˆé‡è¦ï¼ãƒ‡ãƒ¼ã‚¿ãŒæ¶ˆãˆãªã„ã‚ˆã†ã«ã™ã‚‹ï¼‰
    disk:
      name: rei-persistent-storage
      mountPath: /opt/render/project/src/data
      sizeGB: 1  # 1GBï¼ˆChromaDBç”¨ï¼‰
    
    # ãƒ˜ãƒ«ã‚¹ãƒã‚§ãƒƒã‚¯
    healthCheckPath: /health
    
    # è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤
    autoDeploy: true  # GitHubã¸ã®pushæ™‚ã«è‡ªå‹•ãƒ‡ãƒ—ãƒ­ã‚¤

# ====================================================
# ğŸ“Œ é‡è¦ãªæ³¨æ„äº‹é …
# ====================================================
# 
# 1. **æ°¸ç¶šãƒ‡ã‚£ã‚¹ã‚¯ï¼ˆPersistent Diskï¼‰**
#    - Starterãƒ—ãƒ©ãƒ³ä»¥ä¸ŠãŒå¿…è¦ï¼ˆ$7/æœˆã€œï¼‰
#    - data/chroma_db/ ã¨ uploads/ ãŒä¿å­˜ã•ã‚Œã‚‹
#    - ã‚¢ãƒ—ãƒªå†èµ·å‹•æ™‚ã‚‚ãƒ‡ãƒ¼ã‚¿ãŒä¿æŒã•ã‚Œã‚‹
#
# 2. **ç’°å¢ƒå¤‰æ•°ã®è¨­å®š**
#    - Renderãƒ€ãƒƒã‚·ãƒ¥ãƒœãƒ¼ãƒ‰ã§æ‰‹å‹•è¨­å®šå¿…é ˆ:
#      * OPENAI_API_KEY
#      * AZURE_SPEECH_KEY
#
# 3. **ãƒªãƒ¼ã‚¸ãƒ§ãƒ³é¸æŠ**
#    - singapore: æ—¥æœ¬ã‹ã‚‰æœ€ã‚‚è¿‘ã„ï¼ˆãƒ¬ã‚¤ãƒ†ãƒ³ã‚·ä½ï¼‰
#
# 4. **ã‚³ã‚¹ãƒˆ**
#    - Starter: $7/æœˆï¼ˆ512MB RAMã€æ°¸ç¶šãƒ‡ã‚£ã‚¹ã‚¯ï¼‰
#    - Standard: $25/æœˆï¼ˆ2GB RAMï¼‰
#
# ====================================================

